{% extends 'base.html' %}
{% load humanize %}

{% block title %}{{ expedition.platform }} - Система наблюдений{% endblock %}

{% block content %}
    {% include 'include/_breadcrumbs.html' %}


    <div class="card mb-4">
        <div class="card-header">
            <h2 class="card-title mb-0">{{ expedition.platform }}</h2>
        </div>
        <div class="card-body">
            <div class="row">
                <div class="col-md-6">
                    <table class="table table-sm">
                        <tr>
                            <th width="40%">Дата начала:</th>
                            <td>{{ expedition.start_date|date:"d.m.Y H:i" }}</td>
                        </tr>
                        <tr>
                            <th>Дата окончания:</th>
                            <td>{{ expedition.end_date|date:"d.m.Y H:i" }}</td>
                        </tr>
                        <tr>
                            <th>Район работ:</th>
                            <td>{{ expedition.area }}</td>
                        </tr>
                    </table>
                </div>
                <div class="col-md-6">
                    <table class="table table-sm">
                        <tr>
                            <th width="40%">Количество станций:</th>
                            <td>
                                <span class="badge bg-primary">{{ stations.count|intcomma }}</span>
                            </td>
                        </tr>
                        <tr>
                            <th>Количество проб:</th>
                            <td>
                                <span class="badge bg-success">{{ samples_count|intcomma }}</span>
                            </td>
                        </tr>
                        <tr>
                            <th>Длительность:</th>
                            <td>{{ expedition.end_date|timeuntil:expedition.start_date }}</td>
                        </tr>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <div class="card">
        <div class="card-header">
            <h3 class="card-title mb-0">Станции экспедиции</h3>
        </div>
        <div class="card-body">
            {% if stations %}
            <div class="table-responsive">
                <table class="table table-striped table-hover data-table">
                    <thead>
                        <tr>
                            <th>Название станции</th>
                            <th>Широта</th>
                            <th>Долгота</th>
                            <th>Глубина дна (м)</th>
                            <th>Прозрачность (м)</th>
                            <th>Количество проб</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for station in stations %}
                        <tr>
                            <td>{{ station.station_name }}</td>
                            <td>{{ station.latitude|floatformat:4 }}</td>
                            <td>{{ station.longitude|floatformat:4 }}</td>
                            <td>
                                {% if station.bottom_depth %}
                                    {{ station.bottom_depth|floatformat:1 }}
                                {% else %}
                                    <span class="text-muted">—</span>
                                {% endif %}
                            </td>
                            <td>
                                {% if station.secchi_depth %}
                                    {{ station.secchi_depth|floatformat:1 }}
                                {% else %}
                                    <span class="text-muted">—</span>
                                {% endif %}
                            </td>
                            <td>
                                <span class="badge bg-info">{{ station.samples.count }}</span>
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
            {% else %}
            <div class="text-center text-muted py-4">
                <p>Нет данных о станциях для этой экспедиции</p>
            </div>
            {% endif %}
        </div>
    </div>
{% endblock %}